# -*- coding: utf-8 -*-
"""통계데이터분석-선형회귀 VS KNN회귀.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1yz8BMiLp7yWbLzGWlfh6WhxijEq9ahXK

선형 회귀 VS KNN 회귀
"""

import numpy as np
n=1000
heights = np.random.normal(174,8,n)

heights2 = [height//0.5 for height in heights]
import pandas as pd
se = pd.Series(heights2)
svc = se.value_counts()

import matplotlib.pyplot as plt
plt.bar(svc.index,svc.values)
plt.show()

bmi = np.random.normal(21,1,n)
weights = bmi*(heights**2)/10000 #bmi = w/(txt) , t의 단위는 m

plt.figure(figsize=(10,5))
plt.plot(heights,weights,'.')
plt.xlabel("height")
plt.ylabel("weight")
plt.xlim(0,220)
plt.ylim(0,110)
plt.grid(True)
plt.show()

#xs = [ [weight] for weight in weights]
xs = weights.reshape(-1,1) #독립변수는 여러 개의 특성으로 구성할 수 있어서 ML 모델에서는 2차원 배열 형태로 학습 데이터를 입력받음
xs.shape

xs2 = xs.reshape(5,20,-1)
xs2.shape

xs3 = xs.reshape(3,20,-1) #1000개를 3x20xn으로 만들 수 없어서 오류가 발생
xs3.shape

ys = heights #종속변수는 하나의 값이며 ML 모델에서 1차원 배열 형태로 학습 데이터를 입력받음
ys.shape

from sklearn.linear_model import LinearRegression
lr_model = LinearRegression() #모델 개체 생성
lr_model.fit(xs,ys) #학습
lr_model.coef_, lr_model.intercept_ #가중치, 편향

txs = np.array([[50],[60],[67],[70],[94]])

pred_val1 = lr_model.predict(txs)#예측하시오.
pred_val1

from sklearn.neighbors import KNeighborsRegressor
knr_model = KNeighborsRegressor() #모델 개체 생성
knr_model.fit(xs,ys) #학습
pred_val2 = knr_model.predict(txs)#예측하시오.
pred_val2

from sklearn.model_selection import train_test_split
train_xs,test_xs,train_ys,test_ys = train_test_split(xs,ys,train_size=0.8)
train_xs.shape, test_xs.shape,train_ys.shape, test_ys.shape

"""![image.png](data:image/png;base64,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)

SST에 사용한 값은 평균과 실제 값

SSR에 사용한 값은 평균과 예측 값
"""

lr_model = LinearRegression() #모델 개체 생성
lr_model.fit(xs,ys) #학습
train_score = lr_model.score(train_xs,train_ys) #평가하시오.
test_score = lr_model.score(test_xs,test_ys) #평가하시오.
train_score, test_score

knr_model = KNeighborsRegressor() #모델 개체 생성
knr_model.fit(xs,ys) #학습
train_score = knr_model.score(train_xs,train_ys) #평가하시오.
test_score = knr_model.score(test_xs,test_ys) #평가하시오.
train_score, test_score

"""# knn에서 주의할 점"""

pv1 = lr_model.predict([[35],[82],[85],[90],[100],[108],[120],[130]])
pv2 = knr_model.predict([[35],[82],[85],[90],[100],[108],[120],[130]])
pv1,pv2

weights.max()

plt.figure(figsize=(10,5))
plt.plot(heights,weights,'.')
plt.plot([141.54,194.43,197.81,203.44,214.69,223.69,237.20,248.45],[35,82,85,90,100,108,120,130],'bo',label='lr')
plt.plot([157.05,190.83,190.83,190.83,190.83,190.83,190.83,190.83],[35,82,85,90,100,108,120,130],'r^',label='knr')
plt.xlabel("height")
plt.ylabel("weight")
plt.xlim(0,270)
plt.ylim(0,135)
plt.grid(True)
plt.legend()
plt.show()